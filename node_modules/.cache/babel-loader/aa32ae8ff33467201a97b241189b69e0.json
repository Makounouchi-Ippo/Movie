{"ast":null,"code":"var _jsxFileName = \"/Users/mehel-ka/Desktop/Hypertube/src/container/ShoppingCart/ShoppingCart.jsx\";\nimport React, { useEffect, useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport * as actions from '../../store/actions/index';\nimport { useHistory } from 'react-router-dom';\nimport './ShoppingCart.css';\nimport axios from 'axios';\nimport Articles from './Articles/Articles';\nimport Paiement from './Paiment/Paiement';\n\nconst ShoppingCart = () => {\n  const movies = useSelector(state => state.cart.cart);\n  const total = useSelector(state => state.cart.total);\n  const qte = useSelector(state => state.cart.qte);\n  const history = useHistory();\n  const dispatch = useDispatch();\n\n  const resetCart = () => {\n    dispatch(actions.resetCart());\n  };\n\n  const getTotals = () => {\n    dispatch(actions.getTotals());\n  };\n\n  const [orderUser, setOrderUser] = useState([]);\n  const [cbCompleted, setCbCompleted] = useState(null);\n  const [infoUser, setInfoUser] = useState(null);\n  const [mail, setMail] = useState('');\n  const [showModal, setShowModal] = useState(false);\n  useEffect(() => {\n    axios.get(`https://movies-27cd5.firebaseio.com/${localStorage.getItem('id')}/CarteBleu.json/`).then(response => {\n      setCbCompleted(response.data.number);\n    }).catch(err => {});\n    axios.get(`https://movies-27cd5.firebaseio.com/${localStorage.getItem('id')}/user.json/`).then(response => {\n      setInfoUser(response.data.name);\n    }).catch(err => {});\n    axios.get(`https://movies-27cd5.firebaseio.com/${localStorage.getItem('id')}/mail.json/`).then(response => {\n      setMail(response.data.mail);\n    }).catch(err => {\n      setMail(localStorage.getItem('email'));\n    });\n    axios.get(`https://movies-27cd5.firebaseio.com/${localStorage.getItem('id')}/Order.json/`).then(res => {\n      res.data === null ? setOrderUser([]) : setOrderUser(res.data);\n    }).catch(err => {});\n  }, []);\n  useEffect(() => {\n    getTotals();\n  });\n\n  const handleSubmit = () => {\n    if (infoUser && cbCompleted) {\n      let films = JSON.parse(localStorage.getItem('Panier'));\n      let total = JSON.parse(localStorage.getItem(\"total\"));\n      let qte = JSON.parse(localStorage.getItem(\"qte\"));\n      let day = new Date().getDate();\n      let month = new Date().getMonth() + 1;\n      let years = new Date().getFullYear();\n      let date = day + '/' + month + '/' + years;\n      let numberOrder = localStorage.getItem('id').substr(0, 10).toUpperCase() + orderUser.length;\n      let tab = {\n        films,\n        total,\n        qte,\n        date,\n        numberOrder\n      };\n      let newOrder;\n      orderUser === null ? newOrder = [] : newOrder = orderUser;\n      newOrder.push(tab);\n      axios.put(`https://movies-27cd5.firebaseio.com/${localStorage.getItem('id')}/Order.json/`, newOrder).then(response => {\n        localStorage.setItem('commandeSuccess', true);\n        localStorage.setItem('numOrder', orderUser.length - 1);\n        localStorage.removeItem('qte');\n        localStorage.removeItem('total');\n        localStorage.removeItem('Panier');\n        resetCart();\n        history.push('/confirmorder');\n      }).catch(err => {}); // const templateId = 'template_k9mcneq';\n      // sendFeedback(templateId, {message_html: 'message_html', from_name: infoUser, reply_to: mail});\n    } else setShowModal(true);\n  };\n\n  const sendFeedback = (templateId, variables) => {\n    window.emailjs.send('123456789', templateId, variables).then(res => {}).catch(err => {});\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"PageCart\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"Cart\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Articles, {\n    movies: movies,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 16\n    }\n  }), /*#__PURE__*/React.createElement(Paiement, {\n    qte: qte,\n    total: total,\n    submit: handleSubmit,\n    show: showModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 16\n    }\n  })));\n};\n\nexport default ShoppingCart;","map":{"version":3,"sources":["/Users/mehel-ka/Desktop/Hypertube/src/container/ShoppingCart/ShoppingCart.jsx"],"names":["React","useEffect","useState","useSelector","useDispatch","actions","useHistory","axios","Articles","Paiement","ShoppingCart","movies","state","cart","total","qte","history","dispatch","resetCart","getTotals","orderUser","setOrderUser","cbCompleted","setCbCompleted","infoUser","setInfoUser","mail","setMail","showModal","setShowModal","get","localStorage","getItem","then","response","data","number","catch","err","name","res","handleSubmit","films","JSON","parse","day","Date","getDate","month","getMonth","years","getFullYear","date","numberOrder","substr","toUpperCase","length","tab","newOrder","push","put","setItem","removeItem","sendFeedback","templateId","variables","window","emailjs","send"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport * as actions from '../../store/actions/index';\nimport { useHistory } from 'react-router-dom';\nimport './ShoppingCart.css';\nimport axios from 'axios';\n\nimport Articles from './Articles/Articles';\nimport Paiement from './Paiment/Paiement';\n\nconst ShoppingCart = () => {\n    const movies = useSelector(state => state.cart.cart);\n    const total = useSelector(state => state.cart.total);\n    const qte = useSelector(state => state.cart.qte);\n    const history = useHistory();\n    const dispatch = useDispatch();\n    const resetCart = () => { dispatch(actions.resetCart()) };\n    const getTotals = () => { dispatch(actions.getTotals()) };\n    const [orderUser, setOrderUser] = useState([]);\n    const [cbCompleted, setCbCompleted] = useState(null);\n    const [infoUser, setInfoUser] = useState(null);\n    const [mail, setMail] = useState('');\n    const [showModal, setShowModal] = useState(false);\n\n    useEffect(() => {\n        axios.get(`https://movies-27cd5.firebaseio.com/${localStorage.getItem('id')}/CarteBleu.json/`)\n            .then(response => {setCbCompleted(response.data.number)})\n            .catch(err => {})\n        axios.get(`https://movies-27cd5.firebaseio.com/${localStorage.getItem('id')}/user.json/`)\n            .then(response => {setInfoUser(response.data.name) })\n            .catch(err => {})\n        axios.get(`https://movies-27cd5.firebaseio.com/${localStorage.getItem('id')}/mail.json/`)\n            .then(response => {setMail(response.data.mail)})\n            .catch(err => {setMail(localStorage.getItem('email'))})\n        axios.get(`https://movies-27cd5.firebaseio.com/${localStorage.getItem('id')}/Order.json/`)\n            .then(res => {res.data === null ? setOrderUser([]) : setOrderUser(res.data)})\n            .catch(err => {})\n    }, [])\n\n    useEffect(() => {\n        getTotals();\n    })\n\n    const handleSubmit = () => {\n        if (infoUser && cbCompleted) {\n            let films = JSON.parse(localStorage.getItem('Panier'));\n            let total = JSON.parse(localStorage.getItem(\"total\"));\n            let qte = JSON.parse(localStorage.getItem(\"qte\"));\n            let day = new Date().getDate();\n            let month = new Date().getMonth() + 1;\n            let years = new Date().getFullYear();\n            let date = day + '/' + month + '/' + years;\n            let numberOrder = localStorage.getItem('id').substr(0, 10).toUpperCase() + (orderUser.length);\n            let tab = { films, total, qte , date, numberOrder};\n            let newOrder;\n            orderUser === null ? newOrder = [] : newOrder = orderUser;\n            newOrder.push(tab)\n            axios.put(`https://movies-27cd5.firebaseio.com/${localStorage.getItem('id')}/Order.json/`,newOrder)\n            .then(response => {\n                localStorage.setItem('commandeSuccess', true);\n                localStorage.setItem('numOrder', orderUser.length - 1);\n                localStorage.removeItem('qte');\n                localStorage.removeItem('total');\n                localStorage.removeItem('Panier');\n                resetCart();\n                history.push('/confirmorder');\n            }) \n            .catch(err => {})\n            // const templateId = 'template_k9mcneq';\n            // sendFeedback(templateId, {message_html: 'message_html', from_name: infoUser, reply_to: mail});\n        }\n        else    \n            setShowModal(true);\n    }\n\n\n    const sendFeedback = (templateId, variables) => {\n        window.emailjs.send('123456789', templateId,variables)\n        .then(res => {})\n        .catch(err => {})\n    }\n      \n    return (\n        <div className=\"PageCart\">\n            <div className=\"Cart\">\n               <Articles movies={movies}/>\n               <Paiement qte={qte} total={total} submit={handleSubmit} show={showModal}/>\n            </div> \n        </div>\n    )\n}\n\nexport default ShoppingCart;"]},"metadata":{},"sourceType":"module"}